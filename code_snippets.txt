def _powershell_ip(host):  # TODO: WIP
    if PY2:
        import _winreg as winreg
    else:
        import winreg
    try:
        reg = winreg.ConnectRegistry(None, winreg.HKEY_LOCAL_MACHINE)
        ps_key = winreg.OpenKey(reg, r'SOFTWARE\Microsoft\PowerShell')
    except OSError:
        return None
    ps_location = None
    for version in [3, 1]:
        ver_path = str(version) + r'\PowerShellEngine'
        try:
            ver_key = winreg.OpenKey(ps_key, ver_path)
            ps_location = winreg.QueryValueEx(ver_key, 'ApplicationBase')[0]
        except OSError:
            continue
    if not ps_location:
        return None
    ps_path = os.path.join(ps_location, 'powershell.exe')
    if '.' in host:
        cmd = "$hostIp = '%s'; " % host
    else:
        return None
    cmd += r"(gwmi -Class Win32_NetworkAdapterConfiguration | " \
           r"where { $_.IpAddress -eq $hostIp }).MACAddress"
    return _call_proc(ps_path, '-e ' + cmd)